<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Word Pop Match</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;800&family=Fredoka:wght@500;700&display=swap" rel="stylesheet">

    <style>
        /* --- MODERN & PLAYFUL THEME --- */
        :root {
            /* ‡∏™‡∏µ‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏ö‡∏ö‡∏û‡∏≤‡∏™‡πÄ‡∏ó‡∏•‡∏™‡∏î‡πÉ‡∏™ */
            --bg-gradient: linear-gradient(135deg, #FF9A9E 0%, #FECFEF 100%);
            --card-bg: rgba(255, 255, 255, 0.92); /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏∂‡πà‡∏á‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÅ‡∏™‡∏á */
            
            --primary-color: #FF6B6B; /* ‡∏™‡∏µ‡∏´‡∏•‡∏±‡∏Å (‡πÅ‡∏î‡∏á‡∏≠‡∏°‡∏ä‡∏°‡∏û‡∏π) */
            --primary-shadow: #D64545;
            
            --secondary-color: #4ECDC4; /* ‡∏™‡∏µ‡∏£‡∏≠‡∏á (‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏°‡∏¥‡πâ‡∏ô‡∏ï‡πå) */
            --secondary-shadow: #369B93;

            --correct-color: #88D8B0; /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏û‡∏≤‡∏™‡πÄ‡∏ó‡∏• */
            --correct-shadow: #5FB38D;
            
            --wrong-color: #FF8A80; /* ‡πÅ‡∏î‡∏á‡∏û‡∏≤‡∏™‡πÄ‡∏ó‡∏• */
            --wrong-shadow: #D15F55;

            --text-main: #4A4A4A;
            --text-light: #FFFFFF;
            
            --border-radius: 20px;
        }

        /* ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤ */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Sarabun', sans-serif;
            background: var(--bg-gradient);
            color: var(--text-main);
            margin: 0;
            padding: 15px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏ö‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            display: flex;
            justify-content: center;
            align-items: center; 
            min-height: 100vh;
            text-align: center;
        }

        /* ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å (Card Style) */
        .container {
            width: 100%;
            max-width: 480px; /* ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            background-color: var(--card-bg);
            backdrop-filter: blur(10px); /* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏Å‡∏£‡∏∞‡∏à‡∏Å */
            border-radius: var(--border-radius);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            min-height: 85vh;
            max-height: 95vh;
            display: flex;
            flex-direction: column;
            overflow: hidden; /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏´‡∏•‡∏∏‡∏î‡∏Å‡∏£‡∏≠‡∏ö */
            border: 2px solid #FFFFFF;
        }

        /* Header */
        header {
            background: transparent;
            padding: 1rem;
            border-bottom: 2px dashed rgba(0,0,0,0.05);
        }
        header h1 {
            font-family: 'Fredoka', sans-serif; /* ‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏° */
            font-size: 2rem;
            margin: 0;
            color: var(--primary-color);
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
            letter-spacing: 1px;
        }

        /* Screen Management */
        .screen {
            padding: 1rem;
            display: none; 
            flex-grow: 1;
            flex-direction: column;
            overflow-y: auto; /* ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏•‡πâ‡∏ô */
        }
        .screen.active {
            display: flex;
        }

        /* --- Level Selection (Grid) --- */
        #level-select-screen .level-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 4 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            gap: 10px;
            padding: 10px 0;
        }
        
        .level-btn {
            background-color: #FFFFFF;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            border-radius: 12px;
            aspect-ratio: 1/1; /* ‡∏õ‡∏∏‡πà‡∏°‡∏à‡∏±‡∏ï‡∏∏‡∏£‡∏±‡∏™ */
            font-family: 'Fredoka', sans-serif;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 0 var(--primary-shadow);
            transition: transform 0.1s, box-shadow 0.1s;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .level-btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 var(--primary-shadow);
        }

        /* --- Game Screen Layout --- */
        #game-screen {
            justify-content: space-between; /* ‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ */
            padding-bottom: 0; /* ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏° Footer */
        }

        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 700;
            color: #888;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            background: rgba(255,255,255,0.5);
            padding: 8px 15px;
            border-radius: 30px;
        }
        #score { color: var(--primary-color); }

        /* Speaker Button (Hero Section) */
        #prompt-area {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin-bottom: 1rem;
        }
        #audio-button {
            background-color: var(--secondary-color); 
            border: none;
            border-radius: 50%;
            width: 110px; 
            height: 110px; 
            font-size: 3.5rem; 
            cursor: pointer;
            box-shadow: 0 8px 0 var(--secondary-shadow); 
            transition: all 0.1s ease;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #audio-button:active {
            transform: translateY(6px);
            box-shadow: 0 2px 0 var(--secondary-shadow);
        }
        #audio-button:disabled {
            filter: grayscale(0.8);
            opacity: 0.7;
            transform: translateY(6px);
            box-shadow: 0 2px 0 #999;
        }
        #feedback-message {
            margin-top: 15px;
            font-size: 1.1rem;
            height: 1.5em; /* ‡∏à‡∏≠‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà */
        }

        /* Choices Grid (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠) */
        #options-area {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 2 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå */
            gap: 12px;
            width: 100%;
            margin-bottom: 1rem;
        }
        
        .option-btn {
            background-color: white;
            border: 2px solid #EEE;
            border-radius: 16px;
            padding: 15px 5px; /* ‡∏•‡∏î padding ‡∏Ç‡πâ‡∏≤‡∏á */
            cursor: pointer;
            min-height: 70px; /* ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ */
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 0 #DDD;
            transition: all 0.1s;
        }
        
        .option-btn .item-word {
            font-family: 'Fredoka', sans-serif;
            font-size: 1.6rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            font-weight: 600;
            color: var(--text-main);
            line-height: 1.1;
            word-break: break-word; /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ï‡∏Å‡∏Ç‡∏≠‡∏ö */
        }

        .option-btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 #DDD;
        }

        /* ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ñ‡∏π‡∏Å/‡∏ú‡∏¥‡∏î */
        .option-btn.correct {
            background-color: var(--correct-color);
            border-color: var(--correct-shadow);
            box-shadow: 0 4px 0 var(--correct-shadow);
        }
        .option-btn.correct .item-word { color: white; }

        .option-btn.incorrect {
            background-color: var(--wrong-color);
            border-color: var(--wrong-shadow);
            box-shadow: 0 4px 0 var(--wrong-shadow);
            animation: shake 0.4s;
        }
        .option-btn.incorrect .item-word { color: white; }

        @keyframes shake {
            0%, 100% {transform: translateX(0);}
            25% {transform: translateX(-5px);}
            75% {transform: translateX(5px);}
        }

        /* Footer (Sticky Bottom Button) */
        #game-footer {
            padding: 1rem 0;
            width: 100%;
        }
        #next-btn {
            width: 100%;
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 800;
            font-family: 'Sarabun', sans-serif;
            cursor: pointer;
            box-shadow: 0 6px 0 var(--primary-shadow);
            transition: all 0.1s;
        }
        #next-btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 var(--primary-shadow);
        }
        #next-btn:disabled {
            background-color: #CCC;
            box-shadow: 0 6px 0 #999;
            cursor: not-allowed;
        }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á Scrollbar ‡πÉ‡∏´‡πâ‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏° */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.1); border-radius: 10px; }

    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Word Pop</h1>
        </header>

        <div id="level-select-screen" class="screen active">
            <div style="text-align: left; padding: 0 5px;">
                <h2 style="margin: 0; color: #555;">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πà‡∏≤‡∏ô‡∏ù‡∏∂‡∏Å‡∏ù‡∏ô</h2>
                <p style="margin: 5px 0 15px 0; color: #888; font-size: 0.9rem;">20 Levels ‚Ä¢ 200 ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</p>
            </div>
            
            <div class="level-grid" id="level-grid">
                </div>
        </div>

        <div id="game-screen" class="screen">
            <div class="top-content">
                <div class="status-bar">
                    <span id="level-title">Level 1</span>
                    <span id="q-count">1/10</span>
                </div>

                <div id="prompt-area">
                    <button id="audio-button" aria-label="Listen">
                        <span>üîä</span>
                    </button>
                    <div id="feedback-message">‡πÅ‡∏ï‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á</div>
                </div>

                <div id="options-area">
                    </div>
            </div>

            <div id="game-footer">
                <button id="next-btn" disabled>‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ûú</button>
            </div>
        </div>
    </div>
    
    <div id="word-prompt-text" style="display: none;"></div>

    <script>
        /* ------------------- DATA (20 Levels, 10 Words Each) ------------------- */
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å (lowercase) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ TTS ‡∏≠‡πà‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á 100%
        const ALL_LEVEL_WORDS = [
            { level: 1, title: "‡∏™‡∏£‡∏∞ A (‡∏™‡∏±‡πâ‡∏ô)", questions: [
                { word: "cat", correct: "cat", options: ["cut", "cot", "hat", "cat"] },
                { word: "bat", correct: "bat", options: ["bet", "bit", "but", "bat"] },
                { word: "map", correct: "map", options: ["mop", "man", "mate", "map"] },
                { word: "mad", correct: "mad", options: ["bed", "mud", "made", "mad"] },
                { word: "fan", correct: "fan", options: ["fin", "fun", "fed", "fan"] },
                { word: "can", correct: "can", options: ["con", "cut", "ken", "can"] },
                { word: "wag", correct: "wag", options: ["wig", "web", "wog", "wag"] },
                { word: "gap", correct: "gap", options: ["gab", "got", "get", "gap"] },
                { word: "jam", correct: "jam", options: ["jem", "jim", "gum", "jam"] },
                { word: "dad", correct: "dad", options: ["did", "dot", "dude", "dad"] }
            ]},
            { level: 2, title: "‡∏™‡∏£‡∏∞ E, I (‡∏™‡∏±‡πâ‡∏ô)", questions: [
                { word: "red", correct: "red", options: ["rad", "rid", "rod", "red"] },
                { word: "ten", correct: "ten", options: ["tin", "tan", "ton", "ten"] },
                { word: "bed", correct: "bed", options: ["bid", "bad", "bud", "bed"] },
                { word: "pin", correct: "pin", options: ["pan", "pen", "pun", "pin"] },
                { word: "big", correct: "big", options: ["bag", "bug", "beg", "big"] },
                { word: "lip", correct: "lip", options: ["lap", "lop", "lup", "lip"] },
                { word: "six", correct: "six", options: ["sax", "sex", "sux", "six"] },
                { word: "jet", correct: "jet", options: ["jot", "jig", "jag", "jet"] },
                { word: "hen", correct: "hen", options: ["han", "hon", "him", "hen"] },
                { word: "kit", correct: "kit", options: ["cat", "cot", "cut", "kit"] }
            ]},
            { level: 3, title: "‡∏™‡∏£‡∏∞ O, U (‡∏™‡∏±‡πâ‡∏ô)", questions: [
                { word: "fox", correct: "fox", options: ["fix", "fex", "fax", "fox"] },
                { word: "sun", correct: "sun", options: ["son", "sin", "san", "sun"] },
                { word: "box", correct: "box", options: ["back", "bix", "bush", "box"] },
                { word: "dog", correct: "dog", options: ["dig", "dag", "dug", "dog"] },
                { word: "cup", correct: "cup", options: ["cap", "cop", "kip", "cup"] },
                { word: "nut", correct: "nut", options: ["not", "nat", "net", "nut"] },
                { word: "bug", correct: "bug", options: ["bag", "big", "bog", "bug"] },
                { word: "mop", correct: "mop", options: ["map", "mip", "mup", "mop"] },
                { word: "hot", correct: "hot", options: ["hat", "hit", "hut", "hot"] },
                { word: "run", correct: "run", options: ["ran", "rin", "rock", "run"] }
            ]},
            { level: 4, title: "‡∏™‡∏£‡∏∞‡∏ú‡∏™‡∏° 1", questions: [
                { word: "swim", correct: "swim", options: ["swam", "swum", "slim", "swim"] },
                { word: "desk", correct: "desk", options: ["disk", "dusk", "dice", "desk"] },
                { word: "crab", correct: "crab", options: ["crap", "crib", "crop", "crab"] },
                { word: "trip", correct: "trip", options: ["trap", "top", "type", "trip"] },
                { word: "slug", correct: "slug", options: ["slab", "slop", "slim", "slug"] },
                { word: "plum", correct: "plum", options: ["plan", "plot", "plume", "plum"] },
                { word: "frog", correct: "frog", options: ["flag", "fry", "frag", "frog"] },
                { word: "dress", correct: "dress", options: ["draw", "drop", "drift", "dress"] },
                { word: "belt", correct: "belt", options: ["bill", "bolt", "bent", "belt"] },
                { word: "camp", correct: "camp", options: ["comb", "crimp", "clam", "camp"] }
            ]},
            { level: 5, title: "‡∏Ñ‡∏ß‡∏ö‡∏Å‡∏•‡πâ‡∏≥ L", questions: [
                { word: "blue", correct: "blue", options: ["blow", "blew", "buy", "blue"] },
                { word: "clay", correct: "clay", options: ["clue", "clash", "class", "clay"] },
                { word: "glad", correct: "glad", options: ["glass", "gold", "grip", "glad"] },
                { word: "plan", correct: "plan", options: ["plane", "play", "plus", "plan"] },
                { word: "flea", correct: "flea", options: ["fly", "free", "flat", "flea"] },
                { word: "slip", correct: "slip", options: ["slap", "slope", "sleep", "slip"] },
                { word: "club", correct: "club", options: ["clap", "clog", "cube", "club"] },
                { word: "flute", correct: "flute", options: ["float", "fruit", "foot", "flute"] },
                { word: "glove", correct: "glove", options: ["glue", "glass", "globe", "glove"] },
                { word: "plank", correct: "plank", options: ["plane", "plan", "pinch", "plank"] }
            ]},
            { level: 6, title: "‡∏Ñ‡∏ß‡∏ö‡∏Å‡∏•‡πâ‡∏≥ R", questions: [
                { word: "press", correct: "press", options: ["price", "pray", "prince", "press"] },
                { word: "trip", correct: "trip", options: ["trap", "top", "type", "trip"] },
                { word: "bring", correct: "bring", options: ["brain", "rang", "ring", "bring"] },
                { word: "drop", correct: "drop", options: ["drip", "drag", "drove", "drop"] },
                { word: "free", correct: "free", options: ["fly", "frog", "fry", "free"] },
                { word: "grape", correct: "grape", options: ["great", "grip", "grace", "grape"] },
                { word: "crib", correct: "crib", options: ["crop", "crab", "crip", "crib"] },
                { word: "frame", correct: "frame", options: ["firm", "farm", "foam", "frame"] },
                { word: "proud", correct: "proud", options: ["pride", "prize", "pound", "proud"] },
                { word: "train", correct: "train", options: ["trend", "tiny", "turn", "train"] }
            ]},
            { level: 7, title: "‡πÄ‡∏™‡∏µ‡∏¢‡∏á Sh, Ch, Th", questions: [
                { word: "ship", correct: "ship", options: ["sip", "chip", "shop", "ship"] },
                { word: "chair", correct: "chair", options: ["cheer", "care", "share", "chair"] },
                { word: "thumb", correct: "thumb", options: ["sum", "tub", "pump", "thumb"] },
                { word: "cash", correct: "cash", options: ["kiss", "crash", "car", "cash"] },
                { word: "peach", correct: "peach", options: ["pitch", "peak", "push", "peach"] },
                { word: "think", correct: "think", options: ["sink", "thank", "thin", "think"] },
                { word: "shop", correct: "shop", options: ["chop", "ship", "short", "shop"] },
                { word: "lunch", correct: "lunch", options: ["lunge", "latch", "long", "lunch"] },
                { word: "bath", correct: "bath", options: ["bathe", "both", "path", "bath"] },
                { word: "wheel", correct: "wheel", options: ["weel", "whale", "will", "wheel"] }
            ]},
            { level: 8, title: "‡∏™‡∏£‡∏∞‡∏¢‡∏≤‡∏ß A", questions: [
                { word: "make", correct: "make", options: ["mack", "mike", "moke", "make"] },
                { word: "rain", correct: "rain", options: ["ran", "rent", "reign", "rain"] },
                { word: "day", correct: "day", options: ["die", "dot", "due", "day"] },
                { word: "game", correct: "game", options: ["gem", "gome", "gum", "game"] },
                { word: "play", correct: "play", options: ["plea", "ploy", "pull", "play"] },
                { word: "tail", correct: "tail", options: ["tell", "tool", "tile", "tail"] },
                { word: "cake", correct: "cake", options: ["cook", "kick", "kake", "cake"] },
                { word: "bay", correct: "bay", options: ["bye", "bobby", "bee", "bay"] },
                { word: "snail", correct: "snail", options: ["snell", "snarl", "smile", "snail"] },
                { word: "plane", correct: "plane", options: ["plan", "plum", "plain", "plane"] }
            ]},
            { level: 9, title: "‡∏™‡∏£‡∏∞‡∏¢‡∏≤‡∏ß E", questions: [
                { word: "see", correct: "see", options: ["sea", "say", "so", "see"] },
                { word: "meet", correct: "meet", options: ["mate", "might", "meat", "meet"] },
                { word: "leaf", correct: "leaf", options: ["life", "lief", "loff", "leaf"] },
                { word: "green", correct: "green", options: ["grin", "grain", "great", "green"] },
                { word: "feet", correct: "feet", options: ["fit", "fat", "fought", "feet"] },
                { word: "team", correct: "team", options: ["time", "tame", "tome", "team"] },
                { word: "sleep", correct: "sleep", options: ["slip", "slope", "slap", "sleep"] },
                { word: "bee", correct: "bee", options: ["buy", "bay", "bale", "bee"] },
                { word: "tree", correct: "tree", options: ["try", "tray", "tire", "tree"] },
                { word: "read", correct: "read", options: ["rid", "rod", "road", "read"] }
            ]},
            { level: 10, title: "‡∏™‡∏£‡∏∞‡∏¢‡∏≤‡∏ß I", questions: [
                { word: "bike", correct: "bike", options: ["back", "beck", "book", "bike"] },
                { word: "fly", correct: "fly", options: ["flea", "flow", "full", "fly"] },
                { word: "time", correct: "time", options: ["tame", "team", "tome", "time"] },
                { word: "pie", correct: "pie", options: ["pee", "pay", "poy", "pie"] },
                { word: "light", correct: "light", options: ["let", "late", "lout", "light"] },
                { word: "cry", correct: "cry", options: ["crow", "cray", "crew", "cry"] },
                { word: "five", correct: "five", options: ["fife", "for", "fine", "five"] },
                { word: "side", correct: "side", options: ["said", "sad", "sod", "side"] },
                { word: "sky", correct: "sky", options: ["ski", "skay", "sock", "sky"] },
                { word: "high", correct: "high", options: ["hi", "hoe", "hay", "high"] }
            ]},
            { level: 11, title: "‡∏™‡∏£‡∏∞‡∏¢‡∏≤‡∏ß O", questions: [
                { word: "nose", correct: "nose", options: ["noose", "noise", "noss", "nose"] },
                { word: "coat", correct: "coat", options: ["cut", "cot", "kit", "coat"] },
                { word: "snow", correct: "snow", options: ["snip", "snob", "sneeze", "snow"] },
                { word: "boat", correct: "boat", options: ["boot", "bought", "bite", "boat"] },
                { word: "home", correct: "home", options: ["hum", "ham", "hume", "home"] },
                { word: "road", correct: "road", options: ["red", "ride", "rod", "road"] },
                { word: "toe", correct: "toe", options: ["too", "two", "toy", "toe"] },
                { word: "slow", correct: "slow", options: ["slaw", "slot", "slept", "slow"] },
                { word: "note", correct: "note", options: ["nut", "net", "not", "note"] },
                { word: "grow", correct: "grow", options: ["gray", "grip", "gear", "grow"] }
            ]},
            { level: 12, title: "‡∏™‡∏£‡∏∞‡∏¢‡∏≤‡∏ß U", questions: [
                { word: "flute", correct: "flute", options: ["float", "foot", "flat", "flute"] },
                { word: "glue", correct: "glue", options: ["glow", "glew", "glad", "glue"] },
                { word: "moon", correct: "moon", options: ["moan", "man", "mine", "moon"] },
                { word: "blue", correct: "blue", options: ["blow", "blew", "bell", "blue"] },
                { word: "cube", correct: "cube", options: ["cub", "cab", "cop", "cube"] },
                { word: "tool", correct: "tool", options: ["tall", "tale", "toll", "tool"] },
                { word: "food", correct: "food", options: ["fed", "foot", "fade", "food"] },
                { word: "suit", correct: "suit", options: ["set", "sat", "site", "suit"] },
                { word: "mule", correct: "mule", options: ["male", "mile", "moll", "mule"] },
                { word: "pool", correct: "pool", options: ["pole", "pull", "pill", "pool"] }
            ]},
            { level: 13, title: "‡∏™‡∏£‡∏∞ + R", questions: [
                { word: "car", correct: "car", options: ["care", "core", "cur", "car"] },
                { word: "form", correct: "form", options: ["firm", "farm", "foam", "form"] },
                { word: "girl", correct: "girl", options: ["gale", "gore", "gull", "girl"] },
                { word: "her", correct: "her", options: ["hair", "hear", "hire", "her"] },
                { word: "star", correct: "star", options: ["stair", "store", "stir", "star"] },
                { word: "corn", correct: "corn", options: ["coin", "curb", "core", "corn"] },
                { word: "bird", correct: "bird", options: ["beard", "bore", "bred", "bird"] },
                { word: "turn", correct: "turn", options: ["tone", "tin", "torn", "turn"] },
                { word: "park", correct: "park", options: ["perk", "pork", "pike", "park"] },
                { word: "short", correct: "short", options: ["shirt", "shut", "sort", "short"] }
            ]},
            { level: 14, title: "2 ‡∏û‡∏¢‡∏≤‡∏á‡∏Ñ‡πå (‡∏ô‡∏≤‡∏°)", questions: [
                { word: "pencil", correct: "pencil", options: ["pen", "pimple", "pestle", "pencil"] },
                { word: "table", correct: "table", options: ["tailor", "stable", "label", "table"] },
                { word: "tiger", correct: "tiger", options: ["tire", "tighter", "tie", "tiger"] },
                { word: "flower", correct: "flower", options: ["flour", "flow", "foul", "flower"] },
                { word: "cookie", correct: "cookie", options: ["cuckoo", "cooky", "coke", "cookie"] },
                { word: "rocket", correct: "rocket", options: ["rock", "rabbit", "racket", "rocket"] },
                { word: "basket", correct: "basket", options: ["best", "bask", "biscuit", "basket"] },
                { word: "window", correct: "window", options: ["wine", "wind", "winter", "window"] },
                { word: "doctor", correct: "doctor", options: ["duck", "direct", "dot", "doctor"] },
                { word: "magnet", correct: "magnet", options: ["mag", "main", "money", "magnet"] }
            ]},
            { level: 15, title: "2 ‡∏û‡∏¢‡∏≤‡∏á‡∏Ñ‡πå (‡∏Å‡∏£‡∏¥‡∏¢‡∏≤)", questions: [
                { word: "finish", correct: "finish", options: ["fist", "funnel", "fine", "finish"] },
                { word: "listen", correct: "listen", options: ["lessen", "lisp", "lesson", "listen"] },
                { word: "forget", correct: "forget", options: ["forgive", "forgo", "figure", "forget"] },
                { word: "hungry", correct: "hungry", options: ["anger", "hunker", "hairy", "hungry"] },
                { word: "before", correct: "before", options: ["for", "four", "bore", "before"] },
                { word: "happy", correct: "happy", options: ["hoppy", "hip", "help", "happy"] },
                { word: "ready", correct: "ready", options: ["read", "ruddy", "ray", "ready"] },
                { word: "today", correct: "today", options: ["tonight", "toad", "two", "today"] },
                { word: "open", correct: "open", options: ["hope", "oats", "often", "open"] },
                { word: "answer", correct: "answer", options: ["ant", "enter", "and", "answer"] }
            ]},
            { level: 16, title: "3 ‡∏û‡∏¢‡∏≤‡∏á‡∏Ñ‡πå (‡∏á‡πà‡∏≤‡∏¢)", questions: [
                { word: "banana", correct: "banana", options: ["manana", "bandana", "bonanza", "banana"] },
                { word: "family", correct: "family", options: ["famine", "farm", "firmly", "family"] },
                { word: "company", correct: "company", options: ["comet", "come", "comply", "company"] },
                { word: "camera", correct: "camera", options: ["camper", "car", "karma", "camera"] },
                { word: "holiday", correct: "holiday", options: ["hole", "holy", "hallway", "holiday"] },
                { word: "america", correct: "america", options: ["amuse", "merry", "murmur", "america"] },
                { word: "animal", correct: "animal", options: ["annoy", "annual", "ally", "animal"] },
                { word: "bicycle", correct: "bicycle", options: ["bike", "by", "cycle", "bicycle"] },
                { word: "pirate", correct: "pirate", options: ["parade", "private", "prior", "pirate"] },
                { word: "umbrella", correct: "umbrella", options: ["humble", "number", "unreal", "umbrella"] }
            ]},
            { level: 17, title: "3 ‡∏û‡∏¢‡∏≤‡∏á‡∏Ñ‡πå (‡∏Å‡∏•‡∏≤‡∏á)", questions: [
                { word: "difficult", correct: "difficult", options: ["dig", "digging", "daddy", "difficult"] },
                { word: "tomorrow", correct: "tomorrow", options: ["toma", "tummy", "tomb", "tomorrow"] },
                { word: "elephant", correct: "elephant", options: ["elegant", "aloe", "elphant", "elephant"] },
                { word: "yesterday", correct: "yesterday", options: ["yes", "yester", "day", "yesterday"] },
                { word: "continue", correct: "continue", options: ["content", "control", "count", "continue"] },
                { word: "together", correct: "together", options: ["tougher", "toga", "tender", "together"] },
                { word: "accident", correct: "accident", options: ["axe", "action", "access", "accident"] },
                { word: "decorate", correct: "decorate", options: ["deck", "direct", "dot", "decorate"] },
                { word: "delivery", correct: "delivery", options: ["deliver", "delay", "deal", "delivery"] },
                { word: "customer", correct: "customer", options: ["custom", "cast", "cost", "customer"] }
            ]},
            { level: 18, title: "3 ‡∏û‡∏¢‡∏≤‡∏á‡∏Ñ‡πå (‡∏¢‡∏≤‡∏Å)", questions: [
                { word: "important", correct: "important", options: ["impact", "implant", "impatient", "important"] },
                { word: "adventure", correct: "adventure", options: ["advance", "advisor", "advent", "adventure"] },
                { word: "beautiful", correct: "beautiful", options: ["bootiful", "beauty", "butter", "beautiful"] },
                { word: "introduce", correct: "introduce", options: ["intro", "indoor", "interest", "introduce"] },
                { word: "remember", correct: "remember", options: ["member", "reborn", "remover", "remember"] },
                { word: "delicious", correct: "delicious", options: ["delight", "decisive", "delete", "delicious"] },
                { word: "wonderful", correct: "wonderful", options: ["wonder", "wind", "wave", "wonderful"] },
                { word: "surprised", correct: "surprised", options: ["sure", "supply", "side", "surprised"] },
                { word: "exciting", correct: "exciting", options: ["exit", "extra", "exact", "exciting"] },
                { word: "powerful", correct: "powerful", options: ["power", "paw", "push", "powerful"] }
            ]},
            { level: 19, title: "4 ‡∏û‡∏¢‡∏≤‡∏á‡∏Ñ‡πå (‡∏á‡πà‡∏≤‡∏¢)", questions: [
                { word: "computer", correct: "computer", options: ["compare", "compete", "commute", "computer"] },
                { word: "solution", correct: "solution", options: ["solve", "sole", "salute", "solution"] },
                { word: "apology", correct: "apology", options: ["apply", "apple", "apocalypse", "apology"] },
                { word: "necessary", correct: "necessary", options: ["nestle", "nerve", "new", "necessary"] },
                { word: "activity", correct: "activity", options: ["active", "act", "actor", "activity"] },
                { word: "discovery", correct: "discovery", options: ["disagree", "discuss", "disc", "discovery"] },
                { word: "geography", correct: "geography", options: ["geo", "graph", "grave", "geography"] },
                { word: "security", correct: "security", options: ["sure", "secret", "section", "security"] },
                { word: "celebrity", correct: "celebrity", options: ["sell", "select", "cell", "celebrity"] },
                { word: "education", correct: "education", options: ["edit", "echo", "eager", "education"] }
            ]},
            { level: 20, title: "4 ‡∏û‡∏¢‡∏≤‡∏á‡∏Ñ‡πå (‡∏¢‡∏≤‡∏Å)", questions: [
                { word: "vocabulary", correct: "vocabulary", options: ["voice", "vocal", "vacation", "vocabulary"] },
                { word: "experiment", correct: "experiment", options: ["experience", "expert", "express", "experiment"] },
                { word: "vegetable", correct: "vegetable", options: ["very", "vet", "visit", "vegetable"] },
                { word: "advisable", correct: "advisable", options: ["advice", "visual", "visa", "advisable"] },
                { word: "available", correct: "available", options: ["avoid", "avocado", "able", "available"] },
                { word: "community", correct: "community", options: ["common", "comment", "come", "community"] },
                { word: "deliciously", correct: "deliciously", options: ["delight", "deliberate", "delete", "deliciously"] },
                { word: "historical", correct: "historical", options: ["history", "store", "start", "historical"] },
                { word: "magical", correct: "magical", options: ["major", "magic", "manage", "magical"] },
                { word: "technology", correct: "technology", options: ["technical", "tek", "tailor", "technology"] }
            ]}
        ];

        // --- GAME VARIABLES ---
        const MAX_REPLAY_COUNT = 3; 
        const synth = window.speechSynthesis;
        let voice = null; 
        let isSpeaking = false;

        let currentLevelData = null;
        let currentQuizIndex = 0; 
        let score = 0;
        let isAnswered = false;
        let currentWord = {}; 
        let audioPlayCount = 0; 

        // --- DOM ELEMENTS ---
        const levelSelectScreen = document.getElementById('level-select-screen');
        const gameScreen = document.getElementById('game-screen');
        const levelGridEl = document.getElementById('level-grid');
        const levelTitleEl = document.getElementById('level-title');
        const qCountEl = document.getElementById('q-count');
        const audioButton = document.getElementById('audio-button');
        const feedbackMessageEl = document.getElementById('feedback-message');
        const optionsArea = document.getElementById('options-area');
        const nextBtn = document.getElementById('next-btn');

        // --- TTS SYSTEM (CRITICAL FIX) ---
        function initTTS() {
            if (voice) return;
            const voices = synth.getVoices();
            // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
            // Google US English ‡∏°‡∏±‡∏Å‡∏à‡∏∞‡∏≠‡∏≠‡∏Å‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
            voice = voices.find(v => v.name.includes("Google US English")) || 
                    voices.find(v => v.lang === 'en-US') || 
                    voices.find(v => v.lang.startsWith('en-'));
        }

        function speakWord(text) {
            if (!synth || !text) return;
            
            synth.cancel(); // ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÄ‡∏Å‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô
            
            // *** ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÄ‡∏û‡∏¥‡πà‡∏° "." ‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢‡∏Ñ‡∏≥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏Ñ/‡∏Ñ‡∏≥ ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏™‡∏∞‡∏Å‡∏î‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß ***
            const utterance = new SpeechSynthesisUtterance(text + "."); 
            
            utterance.lang = 'en-US'; 
            utterance.rate = 0.9; // ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏õ‡∏Å‡∏ï‡∏¥‡∏Ñ‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏ó‡∏≤‡∏á‡∏ä‡πâ‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ü‡∏±‡∏á‡∏ä‡∏±‡∏î
            utterance.voice = voice;
            
            utterance.onstart = () => { isSpeaking = true; audioButton.disabled = true; };
            utterance.onend = () => { 
                isSpeaking = false; 
                if (!isAnswered && audioPlayCount < MAX_REPLAY_COUNT) {
                    audioButton.disabled = false;
                }
            };
            
            synth.speak(utterance);
        }

        function speakFeedback(text) {
            if (!synth) return;
            synth.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'en-US';
            utterance.voice = voice;
            synth.speak(utterance);
        }

        // --- GAME LOGIC ---
        function createLevelButtons() {
            levelGridEl.innerHTML = '';
            ALL_LEVEL_WORDS.forEach(data => {
                const btn = document.createElement('div');
                btn.className = 'level-btn';
                btn.textContent = data.level;
                btn.onclick = () => startLevel(data.level);
                levelGridEl.appendChild(btn);
            });
        }

        function startLevel(levelId) {
            currentLevelData = ALL_LEVEL_WORDS.find(d => d.level === levelId);
            currentQuizIndex = 0;
            score = 0;
            
            levelSelectScreen.classList.remove('active');
            gameScreen.classList.add('active');
            
            nextQuestion();
        }

        function nextQuestion() {
            if (currentQuizIndex >= currentLevelData.questions.length) {
                alert(`‡∏à‡∏ö‡∏î‡πà‡∏≤‡∏ô! ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: ${score}/10`);
                location.reload(); // ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏á‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
                return;
            }

            isAnswered = false;
            audioPlayCount = 0;
            
            // Reset UI
            nextBtn.disabled = true;
            nextBtn.style.opacity = "0.5";
            feedbackMessageEl.textContent = "‡πÅ‡∏ï‡∏∞‡∏•‡∏≥‡πÇ‡∏û‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á";
            feedbackMessageEl.style.color = "#888";
            audioButton.disabled = false;

            updateStatusBar();
            setupQuestion();
        }

        function updateStatusBar() {
            levelTitleEl.textContent = `Level ${currentLevelData.level}`;
            qCountEl.textContent = `${currentQuizIndex + 1}/10`;
        }

        function setupQuestion() {
            const currentQ = currentLevelData.questions[currentQuizIndex];
            currentWord = currentQ;

            // Shuffle Options
            const shuffledOptions = [...currentQ.options]
                .sort(() => Math.random() - 0.5)
                .map(opt => ({ word: opt, isCorrect: opt === currentQ.correct }));

            optionsArea.innerHTML = '';
            shuffledOptions.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerHTML = `<span class="item-word">${opt.word.toUpperCase()}</span>`; // ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏ç‡πà
                btn.onclick = (e) => handleAnswer(e, opt.isCorrect);
                optionsArea.appendChild(btn);
            });

            // Auto Play (‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å + ‡∏à‡∏∏‡∏î)
            setTimeout(() => {
                speakWord(currentWord.word.toLowerCase());
                audioPlayCount = 1;
            }, 300);
        }

        function handleAnswer(e, isCorrect) {
            if (isAnswered) return;
            isAnswered = true;

            const btn = e.currentTarget;
            audioButton.disabled = true;

            if (isCorrect) {
                score++;
                btn.classList.add('correct');
                feedbackMessageEl.textContent = "‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! Excellent!";
                feedbackMessageEl.style.color = "var(--correct-shadow)";
                speakFeedback("Correct!");
            } else {
                btn.classList.add('incorrect');
                feedbackMessageEl.textContent = `‡∏ú‡∏¥‡∏î! ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏∑‡∏≠ ${currentWord.correct.toUpperCase()}`;
                feedbackMessageEl.style.color = "var(--wrong-shadow)";
                speakFeedback("Incorrect. The answer is " + currentWord.word);
                
                // ‡πÄ‡∏â‡∏•‡∏¢‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å
                document.querySelectorAll('.option-btn').forEach(b => {
                    if (b.textContent.toLowerCase() === currentWord.correct.toLowerCase()) {
                        b.classList.add('correct');
                    }
                });
            }

            // Enable Next Button
            nextBtn.disabled = false;
            nextBtn.style.opacity = "1";
        }

        // --- EVENT LISTENERS ---
        audioButton.onclick = () => {
            if (audioPlayCount < MAX_REPLAY_COUNT && !isSpeaking) {
                speakWord(currentWord.word.toLowerCase());
                audioPlayCount++;
                
                let remaining = MAX_REPLAY_COUNT - audioPlayCount;
                if(remaining > 0) feedbackMessageEl.textContent = `‡∏ü‡∏±‡∏á‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å ${remaining} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á`;
                else feedbackMessageEl.textContent = "‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢!";
            }
        };

        nextBtn.onclick = () => {
            currentQuizIndex++;
            nextQuestion();
        };

        // --- INIT ---
        window.addEventListener('DOMContentLoaded', () => {
            createLevelButtons();
            
            // ‡∏£‡∏≠‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á
            if (synth.onvoiceschanged !== undefined) {
                synth.onvoiceschanged = initTTS;
            }
            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÑ‡∏ß‡πâ
            setTimeout(initTTS, 500);
        });

    </script>
</body>
</html>
