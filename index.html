<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Word Icons Match üöÄ</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Prompt:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Theme Colors */
            --bg-menu: #FFF9C4; /* Yellow for Menu */
            --primary: #6C5CE7;
            --secondary: #A29BFE;
            --accent: #FD79A8;
            --success: #00B894;
            --error: #FF7675;
            --text-dark: #2D3436;
            --text-light: #DFE6E9;
            
            /* Dimensions */
            --card-gap: 8px;
            --radius-xl: 24px;
            --radius-md: 12px;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Prompt', 'Fredoka', sans-serif;
            background-color: var(--bg-menu);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            transition: background-color 0.6s ease;
            overflow-x: hidden;
        }

        /* Mobile Container mimics an App View */
        .app-container {
            width: 100%;
            max-width: 450px;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 40px rgba(0,0,0,0.1);
            position: relative;
        }

        /* --- HEADER --- */
        header {
            padding: 1.2rem 1rem;
            text-align: center;
            background: white;
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
            z-index: 100;
            position: relative;
        }
        header h1 {
            margin: 0;
            font-family: 'Fredoka', sans-serif;
            font-size: 1.8rem;
            color: var(--primary);
            letter-spacing: 1px;
            text-shadow: 2px 2px 0px rgba(0,0,0,0.1);
        }

        /* --- SCREENS --- */
        .screen {
            flex: 1;
            display: none;
            flex-direction: column;
            padding: 1rem;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .screen.active {
            display: flex;
            opacity: 1;
            transform: translateY(0);
        }

        h2 { text-align: center; color: var(--text-dark); margin: 0.5rem 0; font-weight: 700; }
        p.subtitle { text-align: center; color: #636e72; margin-top: 0; font-size: 0.9rem; }

        /* --- LEVEL SELECT GRID --- */
        .level-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            padding: 10px 5px;
            overflow-y: auto;
        }

        /* --- GAME GRID --- */
        .game-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--card-gap);
            width: 100%;
            margin: 0 auto;
            align-content: start;
            padding-bottom: 20px;
        }

        /* --- CARD DESIGN (3D Style) --- */
        .card {
            aspect-ratio: 1 / 1;
            position: relative;
            cursor: pointer;
            perspective: 1000px;
            user-select: none;
        }

        .card-inner {
            width: 100%;
            height: 100%;
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
            border-radius: var(--radius-md);
            position: relative;
            box-shadow: 0 4px 0 rgba(0,0,0,0.1); /* 3D Depth Shadow */
        }

        .card.flipped .card-inner { transform: rotateY(180deg); }
        .card.matched .card-inner { transform: rotateY(180deg) scale(0.95); opacity: 0.6; box-shadow: none; }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-md);
            font-weight: 600;
            overflow: hidden;
            border: 2px solid white;
        }

        .card-back {
            background: var(--card-theme, linear-gradient(135deg, #74b9ff, #0984e3));
            color: rgba(255,255,255,0.8);
            font-size: 1.5rem;
        }
        .card-back::after { content: "?"; font-family: 'Fredoka'; }

        .card-front {
            background: white;
            color: var(--text-dark);
            transform: rotateY(180deg);
            padding: 2px;
            text-align: center;
        }

        .txt-content { font-family: 'Fredoka'; font-size: clamp(0.7rem, 2.5vw, 0.95rem); line-height: 1.1; word-break: break-word; }
        .icon-content { font-size: clamp(1.8rem, 5vw, 2.5rem); }

        /* --- BUTTONS (Neumorphic / 3D) --- */
        .btn {
            border: none;
            padding: 14px;
            border-radius: var(--radius-xl);
            font-family: 'Prompt', sans-serif;
            font-weight: 600;
            font-size: 1rem;
            color: white;
            cursor: pointer;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 10px;
            transition: transform 0.1s, box-shadow 0.1s;
            position: relative;
            box-shadow: 0 4px 0 rgba(0,0,0,0.15); /* 3D Effect */
        }
        .btn:active {
            transform: translateY(4px);
            box-shadow: 0 0 0 rgba(0,0,0,0);
        }

        /* Button Themes */
        .btn-lvl { flex-direction: column; height: 80px; gap: 4px; font-size: 1.1rem; }
        .btn-lvl span { font-size: 0.75rem; opacity: 0.9; font-weight: 400; }
        
        .theme-blue { background: #74b9ff; box-shadow: 0 4px 0 #0984e3; }
        .theme-violet { background: #a29bfe; box-shadow: 0 4px 0 #6c5ce7; }
        .theme-orange { background: #fab1a0; box-shadow: 0 4px 0 #e17055; }
        .theme-teal { background: #81ecec; box-shadow: 0 4px 0 #00cec9; color: #2d3436; }
        .theme-red { background: #ff7675; box-shadow: 0 4px 0 #d63031; }
        
        .btn-play { background: #00b894; box-shadow: 0 4px 0 #00896c; }
        .btn-home { background: #dfe6e9; color: var(--text-dark); box-shadow: 0 4px 0 #b2bec3; }
        .btn-next { background: #0984e3; box-shadow: 0 4px 0 #0652dd; }

        /* --- STATUS BAR --- */
        .status-bar {
            display: flex; justify-content: space-between;
            background: white; padding: 12px 20px;
            border-radius: 20px; margin-bottom: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        .stat { text-align: center; }
        .stat-label { display: block; font-size: 0.7rem; color: #b2bec3; }
        .stat-val { font-family: 'Fredoka'; font-size: 1.1rem; color: var(--text-dark); }

        /* --- SUMMARY LIST --- */
        #summary-list {
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
            padding-bottom: 15px; overflow-y: auto; max-height: 55vh;
        }
        .vocab-card {
            background: white; padding: 10px; border-radius: 12px;
            display: flex; align-items: center; gap: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .v-icon { font-size: 1.5rem; }
        .v-text { display: flex; flex-direction: column; }
        .v-en { font-family: 'Fredoka'; font-weight: 600; color: var(--primary); }
        .v-th { font-size: 0.8rem; color: #636e72; }

        /* --- FEEDBACK MESSAGE --- */
        #feedback {
            height: 30px; text-align: center; font-weight: 600; margin: 5px 0;
            display: flex; align-items: center; justify-content: center;
        }
        .msg-correct { color: var(--success); animation: popIn 0.3s; }
        .msg-wrong { color: var(--error); animation: shake 0.4s; }

        /* --- ANIMATIONS --- */
        @keyframes popIn { 0% { transform: scale(0.5); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .card-anim-enter { animation: fadeUp 0.4s backwards; }

    </style>
</head>
<body>

<div class="app-container">
    <header id="app-header">
        <h1>Word Match üöÄ</h1>
    </header>

    <div id="screen-select" class="screen active">
        <h2>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡πà‡∏≤‡∏ô (Levels)</h2>
        <p class="subtitle">‡∏ù‡∏∂‡∏Å‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ñ‡∏≥‡πÅ‡∏õ‡∏• 15 ‡∏î‡πà‡∏≤‡∏ô</p>
        <div class="level-grid" id="level-list"></div>
    </div>

    <div id="screen-summary" class="screen">
        <h2>‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå Level <span id="sum-lvl">1</span></h2>
        <div id="summary-list"></div>
        <div style="margin-top: auto;">
            <button id="btn-start" class="btn btn-play">üéÆ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°</button>
            <button onclick="goHome()" class="btn btn-home">üè† ‡∏Å‡∏•‡∏±‡∏ö</button>
        </div>
    </div>

    <div id="screen-game" class="screen">
        <div class="status-bar">
            <div class="stat"><span class="stat-label">LEVEL</span><span class="stat-val" id="disp-lvl">1</span></div>
            <div class="stat"><span class="stat-label">MATCH</span><span class="stat-val" id="disp-pair">0/6</span></div>
            <div class="stat"><span class="stat-label">TIME</span><span class="stat-val" id="disp-time">00:00</span></div>
        </div>

        <div class="game-board" id="game-board"></div>
        <div id="feedback"></div>

        <div id="ctrl-play" style="margin-top: auto;">
            <button onclick="goHome()" class="btn btn-home">üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
        </div>

        <div id="ctrl-end" style="margin-top: auto; display: none;">
            <button id="btn-replay" class="btn btn-play">üîÑ ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
            <button id="btn-next" class="btn btn-next">‚ñ∂Ô∏è ‡∏î‡πà‡∏≤‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
            <button onclick="goHome()" class="btn btn-home">üè† ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</button>
        </div>
    </div>
</div>

<script>
    /* --- DATA: 15 LEVELS (90 Pairs total) --- */
    const createData = (w, i, id, th) => ({ word: w, icon: i, matchId: id, thai: th });
    
    // Total 15 Levels x (6 or 8 or 10 or 12 pairs)
    const VOCAB_DB = [
        // L1 (6)
        createData("Cat", "üê±", 1, "‡πÅ‡∏°‡∏ß"), createData("Dog", "üê∂", 2, "‡∏™‡∏∏‡∏ô‡∏±‡∏Ç"), 
        createData("Car", "üöó", 3, "‡∏£‡∏ñ‡∏¢‡∏ô‡∏ï‡πå"), createData("Sun", "‚òÄÔ∏è", 4, "‡∏û‡∏£‡∏∞‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå"), 
        createData("Tree", "üå≥", 5, "‡∏ï‡πâ‡∏ô‡πÑ‡∏°‡πâ"), createData("Ball", "‚öΩ", 6, "‡∏•‡∏π‡∏Å‡∏ö‡∏≠‡∏•"),
        // L2 (6)
        createData("Apple", "üçé", 7, "‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡∏¥‡πâ‡∏•"), createData("Banana", "üçå", 8, "‡∏Å‡∏•‡πâ‡∏ß‡∏¢"), 
        createData("Red", "üî¥", 9, "‡∏™‡∏µ‡πÅ‡∏î‡∏á"), createData("Blue", "üîµ", 10, "‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô"), 
        createData("House", "üè†", 11, "‡∏ö‡πâ‡∏≤‡∏ô"), createData("Clock", "‚è∞", 12, "‡∏ô‡∏≤‡∏¨‡∏¥‡∏Å‡∏≤"),
        // L3 (6)
        createData("Walk", "üö∂", 13, "‡πÄ‡∏î‡∏¥‡∏ô"), createData("Run", "üèÉ", 14, "‡∏ß‡∏¥‡πà‡∏á"), 
        createData("Sit", "ü™ë", 15, "‡∏ô‡∏±‡πà‡∏á"), createData("Sleep", "üò¥", 16, "‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö"), 
        createData("Drink", "ü•õ", 17, "‡∏î‡∏∑‡πà‡∏°"), createData("Eat", "üçΩÔ∏è", 18, "‡∏Å‡∏¥‡∏ô"),
        // L4 (6)
        createData("Gift", "üéÅ", 19, "‡∏Ç‡∏≠‡∏á‡∏Ç‡∏ß‡∏±‡∏ç"), createData("Love", "‚ù§Ô∏è", 20, "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å"), 
        createData("Happy", "üòä", 21, "‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç"), createData("Sad", "üòî", 22, "‡πÄ‡∏™‡∏µ‡∏¢‡πÉ‡∏à"), 
        createData("Idea", "üí°", 23, "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î"), createData("Key", "üîë", 24, "‡∏Å‡∏∏‡∏ç‡πÅ‡∏à"),
        // L5 (8)
        createData("Money", "üí∞", 25, "‡πÄ‡∏á‡∏¥‡∏ô"), createData("Ticket", "üé´", 26, "‡∏ï‡∏±‡πã‡∏ß"), 
        createData("Pen", "üñäÔ∏è", 27, "‡∏õ‡∏≤‡∏Å‡∏Å‡∏≤"), createData("Cup", "‚òï", 28, "‡∏ñ‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡πÅ‡∏ü"), 
        createData("Flag", "üö©", 29, "‡∏ò‡∏á"), createData("Water", "üíß", 30, "‡∏ô‡πâ‡∏≥"),
        createData("Fire", "üî•", 31, "‡πÑ‡∏ü"), createData("Book", "üìö", 32, "‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠"),
        // L6 (8)
        createData("Cloud", "‚òÅÔ∏è", 33, "‡πÄ‡∏°‡∏Ü"), createData("Rain", "üåßÔ∏è", 34, "‡∏ù‡∏ô"), 
        createData("Snow", "‚ùÑÔ∏è", 35, "‡∏´‡∏¥‡∏°‡∏∞"), createData("Flower", "üå∏", 36, "‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ"), 
        createData("Mountain", "‚õ∞Ô∏è", 37, "‡∏†‡∏π‡πÄ‡∏Ç‡∏≤"), createData("Moon", "üåï", 38, "‡∏û‡∏£‡∏∞‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå"),
        createData("Road", "üõ£Ô∏è", 39, "‡∏ñ‡∏ô‡∏ô"), createData("Boat", "‚õµ", 40, "‡πÄ‡∏£‡∏∑‡∏≠"),
        // L7 (8)
        createData("Doctor", "üßë‚Äç‚öïÔ∏è", 41, "‡∏´‡∏°‡∏≠"), createData("Police", "üëÆ", 42, "‡∏ï‡∏≥‡∏£‡∏ß‡∏à"), 
        createData("Chef", "üßë‚Äçüç≥", 43, "‡∏û‡πà‡∏≠‡∏Ñ‡∏£‡∏±‡∏ß"), createData("King", "üëë", 44, "‡∏£‡∏≤‡∏ä‡∏≤"), 
        createData("Family", "üë™", 45, "‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß"), createData("Baby", "üë∂", 46, "‡∏ó‡∏≤‡∏£‡∏Å"),
        createData("Hand", "‚úã", 47, "‡∏°‡∏∑‡∏≠"), createData("Eye", "üëÅÔ∏è", 48, "‡∏ï‡∏≤"),
        // L8 (8)
        createData("Ear", "üëÇ", 49, "‡∏´‡∏π"), createData("Computer", "üñ•Ô∏è", 50, "‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå"), 
        createData("Mouse", "üñ±Ô∏è", 51, "‡πÄ‡∏°‡∏≤‡∏™‡πå"), createData("Email", "üìß", 52, "‡∏≠‡∏µ‡πÄ‡∏°‡∏•"), 
        createData("Calendar", "üìÖ", 53, "‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô"), createData("Bus", "üöå", 54, "‡∏£‡∏ñ‡∏ö‡∏±‡∏™"),
        createData("Truck", "üöö", 55, "‡∏£‡∏ñ‡∏ö‡∏£‡∏£‡∏ó‡∏∏‡∏Å"), createData("Pizza", "üçï", 56, "‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤"),
        // L9 (10)
        createData("Wine", "üç∑", 57, "‡πÑ‡∏ß‡∏ô‡πå"), createData("Beer", "üç∫", 58, "‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå"), 
        createData("Shirt", "üëï", 59, "‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡πÄ‡∏ä‡∏¥‡πâ‡∏ï"), createData("Camera", "üì∑", 60, "‡∏Å‡∏•‡πâ‡∏≠‡∏á"), 
        createData("Video", "üìπ", 61, "‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠"), createData("Note", "üìù", 62, "‡πÇ‡∏ô‡πâ‡∏ï"),
        createData("Math", "üßÆ", 63, "‡∏Ñ‡∏ì‡∏¥‡∏ï‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå"), createData("Globe", "üåç", 64, "‡∏•‡∏π‡∏Å‡πÇ‡∏•‡∏Å"), 
        createData("Bag", "üëú", 65, "‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤"), createData("Bike", "üö≤", 66, "‡∏à‡∏±‡∏Å‡∏£‡∏¢‡∏≤‡∏ô"),
        // L10 (10)
        createData("Train", "üöÇ", 67, "‡∏£‡∏ñ‡πÑ‡∏ü"), createData("Tent", "‚õ∫", 68, "‡πÄ‡∏ï‡πá‡∏ô‡∏ó‡πå"), 
        createData("Wifi", "üì∂", 69, "‡πÑ‡∏ß‡πÑ‡∏ü"), createData("Lock", "üîí", 70, "‡∏•‡πá‡∏≠‡∏Ñ"), 
        createData("Open", "üîì", 71, "‡πÄ‡∏õ‡∏¥‡∏î"), createData("Up", "‚¨ÜÔ∏è", 72, "‡∏Ç‡∏∂‡πâ‡∏ô"),
        createData("Down", "‚¨áÔ∏è", 73, "‡∏•‡∏á"), createData("Plus", "‚ûï", 74, "‡∏ö‡∏ß‡∏Å"), 
        createData("Minus", "‚ûñ", 75, "‡∏•‡∏ö"), createData("Star", "‚≠ê", 76, "‡∏î‡∏≤‡∏ß"),
        // L11 (12)
        createData("Game", "üéÆ", 77, "‡πÄ‡∏Å‡∏°"), createData("Music", "üéµ", 78, "‡∏î‡∏ô‡∏ï‡∏£‡∏µ"), 
        createData("Mute", "üîá", 79, "‡∏õ‡∏¥‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏á"), createData("Volume", "üîä", 80, "‡πÄ‡∏™‡∏µ‡∏¢‡∏á"), 
        createData("Lamp", "üõãÔ∏è", 81, "‡πÇ‡∏Ñ‡∏°‡πÑ‡∏ü"), createData("Bed", "üõèÔ∏è", 82, "‡πÄ‡∏ï‡∏µ‡∏¢‡∏á"),
        createData("Bath", "üõÅ", 83, "‡∏≠‡πà‡∏≤‡∏á"), createData("Toilet", "üöΩ", 84, "‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥"), 
        createData("Earth", "üåé", 85, "‡πÇ‡∏•‡∏Å"), createData("Mars", "üî¥", 86, "‡∏î‡∏≤‡∏ß‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£"), 
        createData("Ring", "üíç", 87, "‡πÅ‡∏´‡∏ß‡∏ô"), createData("Diamond", "üíé", 88, "‡πÄ‡∏û‡∏ä‡∏£"),
        // L12 (12)
        createData("Shield", "üõ°Ô∏è", 89, "‡πÇ‡∏•‡πà"), createData("Sword", "‚öîÔ∏è", 90, "‡∏î‡∏≤‡∏ö"), 
        createData("Crown", "üëë", 91, "‡∏°‡∏á‡∏Å‡∏∏‡∏é"), createData("Castle", "üè∞", 92, "‡∏õ‡∏£‡∏≤‡∏™‡∏≤‡∏ó"), 
        createData("Ghost", "üëª", 93, "‡∏ú‡∏µ"), createData("Witch", "üßô", 94, "‡πÅ‡∏°‡πà‡∏°‡∏î"),
        createData("Alien", "üëΩ", 95, "‡πÄ‡∏≠‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏ô"), createData("Robot", "ü§ñ", 96, "‡∏´‡∏∏‡πà‡∏ô‡∏¢‡∏ô‡∏ï‡πå"), 
        createData("Skull", "üíÄ", 97, "‡∏Å‡∏∞‡πÇ‡∏´‡∏•‡∏Å"), createData("Bomb", "üí£", 98, "‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î"), 
        createData("Rocket", "üöÄ", 99, "‡∏à‡∏£‡∏ß‡∏î"), createData("UFO", "üõ∏", 100, "‡∏à‡∏≤‡∏ô‡∏ö‡∏¥‡∏ô"),
        // L13 (12)
        createData("Lion", "ü¶Å", 101, "‡∏™‡∏¥‡∏á‡πÇ‡∏ï"), createData("Tiger", "üêØ", 102, "‡πÄ‡∏™‡∏∑‡∏≠"), 
        createData("Bear", "üêª", 103, "‡∏´‡∏°‡∏µ"), createData("Elephant", "üêò", 104, "‡∏ä‡πâ‡∏≤‡∏á"), 
        createData("Monkey", "üêµ", 105, "‡∏•‡∏¥‡∏á"), createData("Panda", "üêº", 106, "‡πÅ‡∏û‡∏ô‡∏î‡πâ‡∏≤"), 
        createData("Koala", "üê®", 107, "‡πÇ‡∏Ñ‡∏≠‡∏≤‡∏•‡πà‡∏≤"), createData("Pig", "üê∑", 108, "‡∏´‡∏°‡∏π"),
        createData("Fox", "ü¶ä", 109, "‡∏à‡∏¥‡πâ‡∏á‡∏à‡∏≠‡∏Å"), createData("Rabbit", "üê∞", 110, "‡∏Å‡∏£‡∏∞‡∏ï‡πà‡∏≤‡∏¢"),
        createData("Chicken", "üêî", 111, "‡πÑ‡∏Å‡πà"), createData("Duck", "ü¶Ü", 112, "‡πÄ‡∏õ‡πá‡∏î"),
        // L14 (12)
        createData("Grape", "üçá", 113, "‡∏≠‡∏á‡∏∏‡πà‡∏ô"), createData("Melon", "üçà", 114, "‡πÄ‡∏°‡∏•‡πà‡∏≠‡∏ô"), 
        createData("Lemon", "üçã", 115, "‡∏°‡∏∞‡∏ô‡∏≤‡∏ß"), createData("Peach", "üçë", 116, "‡∏•‡∏π‡∏Å‡∏û‡∏µ‡∏ä"), 
        createData("Cherry", "üçí", 117, "‡πÄ‡∏ä‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà"), createData("Strawberry", "üçì", 118, "‡∏™‡∏ï‡∏£‡∏≠‡∏ß‡πå‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ"), 
        createData("Kiwi", "ü•ù", 119, "‡∏Å‡∏µ‡∏ß‡∏µ‡πà"), createData("Corn", "üåΩ", 120, "‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î"),
        createData("Carrot", "ü•ï", 121, "‡πÅ‡∏Ñ‡∏£‡∏≠‡∏ó"), createData("Potato", "ü•î", 122, "‡∏°‡∏±‡∏ô‡∏ù‡∏£‡∏±‡πà‡∏á"),
        createData("Tomato", "üçÖ", 123, "‡∏°‡∏∞‡πÄ‡∏Ç‡∏∑‡∏≠‡πÄ‡∏ó‡∏®"), createData("Onion", "üßÖ", 124, "‡∏´‡∏≠‡∏°‡πÉ‡∏´‡∏ç‡πà"),
        // L15 (12)
        createData("Glasses", "üëì", 125, "‡πÅ‡∏ß‡πà‡∏ô‡∏ï‡∏≤"), createData("Sunglasses", "üï∂Ô∏è", 126, "‡πÅ‡∏ß‡πà‡∏ô‡∏Å‡∏±‡∏ô‡πÅ‡∏î‡∏î"),
        createData("Tie", "üëî", 127, "‡πÄ‡∏ô‡∏Ñ‡πÑ‡∏ó"), createData("Jeans", "üëñ", 128, "‡∏¢‡∏µ‡∏ô‡∏™‡πå"),
        createData("Dress", "üëó", 129, "‡πÄ‡∏î‡∏£‡∏™"), createData("Bikini", "üëô", 130, "‡∏ö‡∏¥‡∏Å‡∏¥‡∏ô‡∏µ‡πà"),
        createData("Purse", "üëõ", 131, "‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤"), createData("Shoe", "üëû", 132, "‡∏£‡∏≠‡∏á‡πÄ‡∏ó‡πâ‡∏≤"),
        createData("Sneaker", "üëü", 133, "‡∏ú‡πâ‡∏≤‡πÉ‡∏ö"), createData("Heels", "üë†", 134, "‡∏™‡πâ‡∏ô‡∏™‡∏π‡∏á"),
        createData("Boot", "üë¢", 135, "‡∏ö‡∏π‡∏ó"), createData("Cap", "üß¢", 136, "‡∏´‡∏°‡∏ß‡∏Å")
    ];

    const LEVELS_CFG = [
        {id:1, grid:'4x3', start:0, count:6}, {id:2, grid:'4x3', start:6, count:6},
        {id:3, grid:'4x3', start:12, count:6}, {id:4, grid:'4x3', start:18, count:6},
        {id:5, grid:'4x4', start:24, count:8}, {id:6, grid:'4x4', start:32, count:8},
        {id:7, grid:'4x4', start:40, count:8}, {id:8, grid:'4x4', start:48, count:8},
        {id:9, grid:'4x5', start:56, count:10}, {id:10, grid:'4x5', start:66, count:10},
        {id:11, grid:'4x6', start:76, count:12}, {id:12, grid:'4x6', start:88, count:12},
        {id:13, grid:'4x6', start:100, count:12}, {id:14, grid:'4x6', start:112, count:12},
        {id:15, grid:'4x6', start:124, count:12}
    ];

    // --- STATE ---
    let currentLevel = 1;
    let cards = [];
    let flipped = [];
    let pairsFound = 0;
    let timer = null;
    let timeStart = 0;
    let isLocked = false;

    // --- SETUP ---
    function init() {
        const grid = document.getElementById('level-list');
        LEVELS_CFG.forEach(lvl => {
            const btn = document.createElement('button');
            // Theme Class
            let cls = 'theme-blue';
            if(lvl.id > 4) cls = 'theme-violet';
            if(lvl.id > 8) cls = 'theme-orange';
            if(lvl.id > 10) cls = 'theme-teal';
            if(lvl.id > 12) cls = 'theme-red';

            btn.className = `btn btn-lvl ${cls}`;
            btn.innerHTML = `Level ${lvl.id}<span>${lvl.grid}</span>`;
            btn.onclick = () => showSummary(lvl.id);
            grid.appendChild(btn);
        });

        // Event Listeners
        document.getElementById('btn-start').onclick = () => startGame(currentLevel);
        document.getElementById('btn-replay').onclick = () => startGame(currentLevel);
        document.getElementById('btn-next').onclick = () => showSummary(currentLevel + 1);
    }

    // --- FLOW ---
    function showSummary(lvlId) {
        if(lvlId > LEVELS_CFG.length) return goHome();
        currentLevel = lvlId;
        
        applyTheme(lvlId);
        switchScreen('screen-summary');
        
        document.getElementById('sum-lvl').textContent = lvlId;
        const cfg = LEVELS_CFG.find(l => l.id === lvlId);
        const words = VOCAB_DB.slice(cfg.start, cfg.start + cfg.count);
        
        const list = document.getElementById('summary-list');
        list.innerHTML = '';
        words.forEach(w => {
            list.innerHTML += `
                <div class="vocab-card">
                    <span class="v-icon">${w.icon}</span>
                    <div class="v-text">
                        <span class="v-en">${w.word}</span>
                        <span class="v-th">${w.thai}</span>
                    </div>
                </div>`;
        });
    }

    function startGame(lvlId) {
        switchScreen('screen-game');
        
        const cfg = LEVELS_CFG.find(l => l.id === lvlId);
        const words = VOCAB_DB.slice(cfg.start, cfg.start + cfg.count);
        
        // Reset
        flipped = [];
        pairsFound = 0;
        isLocked = false;
        document.getElementById('disp-lvl').textContent = lvlId;
        document.getElementById('disp-pair').textContent = `0/${cfg.count}`;
        document.getElementById('feedback').innerHTML = '';
        
        // Controls
        document.getElementById('ctrl-play').style.display = 'block';
        document.getElementById('ctrl-end').style.display = 'none';

        // Timer
        timeStart = Date.now();
        clearInterval(timer);
        timer = setInterval(() => {
            const d = Math.floor((Date.now() - timeStart)/1000);
            const m = String(Math.floor(d/60)).padStart(2,'0');
            const s = String(d%60).padStart(2,'0');
            document.getElementById('disp-time').textContent = `${m}:${s}`;
        }, 1000);

        // Grid
        const board = document.getElementById('game-board');
        board.innerHTML = '';
        
        // Create Deck
        let deck = [];
        words.forEach(w => {
            deck.push({type:'word', ...w});
            deck.push({type:'icon', ...w});
        });
        // Shuffle
        deck.sort(() => Math.random() - 0.5);
        
        // Render with Staggered Animation
        cards = deck;
        deck.forEach((c, idx) => {
            const card = document.createElement('div');
            card.className = 'card card-anim-enter';
            card.style.animationDelay = `${idx * 0.05}s`; // Stagger effect
            card.dataset.idx = idx;
            card.onclick = handleCardClick;
            
            const content = c.type === 'word' 
                ? `<span class="txt-content">${c.word}</span>` 
                : `<span class="icon-content">${c.icon}</span>`;

            card.innerHTML = `
                <div class="card-inner">
                    <div class="card-face card-front">${content}</div>
                    <div class="card-face card-back"></div>
                </div>`;
            board.appendChild(card);
        });
    }

    function handleCardClick(e) {
        if(isLocked) return;
        const el = e.currentTarget;
        const idx = el.dataset.idx;
        
        if(el.classList.contains('flipped') || el.classList.contains('matched')) return;

        playBeep(600); // Click sound
        el.classList.add('flipped');
        flipped.push({el, data: cards[idx]});

        if(flipped.length === 2) {
            isLocked = true;
            checkMatch();
        }
    }

    function checkMatch() {
        const [c1, c2] = flipped;
        const isMatch = c1.data.matchId === c2.data.matchId;

        if(isMatch) {
            pairsFound++;
            playBeep(900, 'sine', 0.2); // Success sound
            document.getElementById('feedback').innerHTML = `<span class="msg-correct">‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°! ${c1.data.word}</span>`;
            document.getElementById('disp-pair').textContent = `${pairsFound}/${LEVELS_CFG.find(l=>l.id===currentLevel).count}`;

            // TTS Fix: Convert to Lowercase for correct pronunciation
            speak(c1.data.word.toLowerCase());

            setTimeout(() => {
                c1.el.classList.add('matched');
                c2.el.classList.add('matched');
                flipped = [];
                isLocked = false;
                
                if(pairsFound === LEVELS_CFG.find(l=>l.id===currentLevel).count) endGame();
            }, 800);
        } else {
            playBeep(150, 'sawtooth', 0.3); // Error sound
            document.getElementById('feedback').innerHTML = `<span class="msg-wrong">‡∏ú‡∏¥‡∏î‡∏à‡πâ‡∏≤!</span>`;
            setTimeout(() => {
                c1.el.classList.remove('flipped');
                c2.el.classList.remove('flipped');
                flipped = [];
                isLocked = false;
            }, 1000);
        }
    }

    function endGame() {
        clearInterval(timer);
        document.getElementById('feedback').innerHTML = `<span class="msg-correct" style="font-size:1.2rem">üéâ ‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß!</span>`;
        document.getElementById('ctrl-play').style.display = 'none';
        document.getElementById('ctrl-end').style.display = 'flex';
        
        if(currentLevel === 15) document.getElementById('btn-next').style.display = 'none';
        else document.getElementById('btn-next').style.display = 'flex';
    }

    // --- UTILS ---
    function switchScreen(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        window.scrollTo(0,0);
    }

    function goHome() {
        clearInterval(timer);
        window.speechSynthesis.cancel();
        // Reset Theme to Menu (Yellow)
        document.body.style.backgroundColor = '#FFF9C4';
        document.querySelector('header').style.background = 'white';
        document.querySelector('header h1').style.color = '#6C5CE7';
        switchScreen('screen-select');
    }

    function applyTheme(lvl) {
        let bg, card, head;
        if(lvl <= 4) { bg='#E3F2FD'; card='linear-gradient(135deg, #74b9ff, #0984e3)'; head='linear-gradient(135deg, #74b9ff, #0984e3)'; }
        else if(lvl <= 8) { bg='#F3E5F5'; card='linear-gradient(135deg, #a29bfe, #6c5ce7)'; head='linear-gradient(135deg, #a29bfe, #6c5ce7)'; }
        else if(lvl <= 10) { bg='#FFF3E0'; card='linear-gradient(135deg, #fab1a0, #e17055)'; head='linear-gradient(135deg, #fab1a0, #e17055)'; }
        else if(lvl <= 12) { bg='#E0F2F1'; card='linear-gradient(135deg, #81ecec, #00cec9)'; head='linear-gradient(135deg, #81ecec, #00cec9)'; }
        else { bg='#FFEBEE'; card='linear-gradient(135deg, #ff7675, #d63031)'; head='linear-gradient(135deg, #ff7675, #d63031)'; }
        
        document.body.style.backgroundColor = bg;
        document.documentElement.style.setProperty('--card-theme', card);
        document.querySelector('header').style.background = head;
        document.querySelector('header h1').style.color = 'white';
    }

    // --- AUDIO ---
    function speak(text) {
        window.speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'en-US';
        u.rate = 0.9;
        window.speechSynthesis.speak(u);
    }

    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playBeep(freq, type='sine', dur=0.1) {
        if(audioCtx.state === 'suspended') audioCtx.resume();
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = type;
        o.frequency.value = freq;
        g.gain.setValueAtTime(0.1, audioCtx.currentTime);
        g.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + dur);
        o.connect(g); g.connect(audioCtx.destination);
        o.start(); o.stop(audioCtx.currentTime + dur);
    }

    init();
</script>
</body>
</html>
