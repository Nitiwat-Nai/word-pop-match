<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Pop Match - ‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</title> <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700;900&display=swap" rel="stylesheet">

    <style>
        /* --- New Child-Friendly Color Theme (2. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ò‡∏µ‡∏°‡∏™‡∏µ) --- */
        :root {
            --color-primary: #FF4081; /* Pink/Fuchsia (‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏≥‡πÇ‡∏û‡∏á/Next) */
            --color-secondary: #4DD0E1; /* Light Cyan (‡∏Ç‡∏≠‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å) */
            --color-correct: #8BC34A; /* Lime Green */
            --color-wrong: #FF7043; /* Vivid Orange */
            --color-bg: #E0F7FA; /* Very Light Cyan (‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á) */
            --color-card: #FFFFFF; /* White (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Header/‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•) */
            --color-button-bg: #FFFDE7; /* Creamy Yellow (‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å) */
            --color-text-dark: #333333;
            --color-text-light: #FFFFFF;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text-dark);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center; 
            min-height: 100vh;
            text-align: center;
        }

        .container {
            width: 100%;
            max-width: 500px; 
            box-sizing: border-box;
            background-color: var(--color-card);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            padding: 0;
        }

        header {
            background-color: var(--color-primary);
            color: var(--color-text-light);
            padding: 1.5rem 1rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        }
        header h1 {
            font-size: 1.8rem;
            margin: 0;
        }

        .screen {
            padding: 1rem;
            display: none; 
            flex-grow: 1;
            flex-direction: column;
            justify-content: space-between;
        }
        .screen.active {
            display: flex;
        }

        /* --- Level Selection Screen --- */
        #level-select-screen .level-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            padding: 1rem 0;
        }
        .level-btn {
            background-color: var(--color-primary); 
            color: var(--color-text-light);
            border: none;
            padding: 1.5rem 0.5rem;
            border-radius: 12px;
            font-size: 1.4rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 0 #D81B60; /* Darker Pink */
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .level-btn-title {
            font-size: 0.8rem;
            font-weight: 400;
            display: block;
            margin-top: 5px;
        }

        /* --- Game Screen --- */
        #game-screen .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #C2185B; /* Deep Pink */
        }

        /* Prompt Area (Speaker Button ONLY) */
        #prompt-area {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin-bottom: 1.5rem;
            min-height: 150px; 
        }
        /* 1. ‡πÄ‡∏≠‡∏≤‡∏Ñ‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏≠‡∏≠‡∏Å */
        /* #word-prompt-text ‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å HTML ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡πÄ‡∏Å‡πá‡∏ö CSS ‡πÑ‡∏ß‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ */
        #word-prompt-text {
            display: none; 
        }
        #audio-button {
            background-color: var(--color-primary); 
            border: none;
            border-radius: 50%;
            width: 120px; /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏≥‡πÇ‡∏û‡∏á */
            height: 120px; 
            font-size: 4em; 
            cursor: pointer;
            box-shadow: 0 6px 0 #D81B60; 
            transition: transform 0.1s ease;
            color: var(--color-text-light); 
        }
        
        /* Choices Area (4-button Grid) */
        #options-area {
            display: grid;
            grid-template-columns: 1fr 1fr; 
            gap: 15px;
            flex-grow: 1; 
            padding-bottom: 1rem;
            max-width: 400px; 
            margin: 0 auto; 
            width: 100%; 
        }
        .option-btn {
            background-color: var(--color-button-bg);
            border: 5px solid var(--color-secondary); 
            border-radius: 15px; 
            padding: 10px;
            cursor: pointer;
            aspect-ratio: 1 / 1; 
            box-sizing: border-box;
            
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        /* 5. ‡πÄ‡∏≠‡∏≤‡∏£‡∏π‡∏õ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£ */
        .option-btn .item-word {
            font-size: 2em; /* ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å */
            font-weight: 900;
            color: var(--color-text-dark);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .option-btn.correct {
            border-color: var(--color-correct) !important; 
            box-shadow: 0 0 20px #8BC34A; 
            transform: scale(1.05);
            background-color: #F1F8E9; /* Light Green */
        }
        .option-btn.incorrect {
            border-color: var(--color-wrong) !important; 
            animation: shake 0.5s;
            background-color: #FFEBEE; 
        }

        /* Footer */
        #next-btn {
            background-color: var(--color-primary);
            color: var(--color-text-light);
            box-shadow: 0 4px 0 #D81B60;
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Word Pop Match</h1>
        </header>

        <div id="level-select-screen" class="screen active">
            <h2>üéâ ‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå</h2>
            <p>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∏‡∏î‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏ù‡∏ô:</p>
            <div class="level-grid" id="level-grid">
                </div>
            <p style="padding-top: 2rem; color:#9E9E9E;">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ü‡∏±‡∏á 10 Levels</p>
        </div>

        <div id="game-screen" class="screen">
            <div class="top-content">
                <div class="status-bar">
                    <span id="level-title"></span>
                    <span id="q-count">‡∏Ç‡πâ‡∏≠: 0/10</span>
                    <span id="score">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: 0</span>
                </div>

                <div id="prompt-area">
                    <button id="audio-button" aria-label="Listen to the word">
                        <span class="speaker-icon">üîä</span>
                    </button>
                    <div id="feedback-message" style="margin-top:10px; font-weight:bold; color:var(--color-text-dark);"></div>
                </div>

                <div id="options-area">
                    </div>
            </div>

            <div id="game-footer">
                <button id="next-btn" disabled>‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
            </div>
        </div>
    </div>
    
    <div id="word-prompt-text" style="display: none;"></div>

    <script>
        /* ------------------- JavaScript Core Logic (‡πÉ‡∏ä‡πâ TTS) ------------------- */

        // --- DATA (4. ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ô) ---
        const ALL_LEVEL_WORDS = [
            // LEVEL 1: Rhyming CVC Words (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏Å)
            { level: 1, title: "‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏™‡∏£‡∏∞‡∏™‡∏±‡πâ‡∏ô (Rhyme)", questions: [
                { word: "RED", correct: "RED", options: ["BED", "FED", "RED", "LID"] },
                { word: "CAT", correct: "CAT", options: ["CUT", "HAT", "CAT", "GET"] },
                { word: "SUN", correct: "SUN", options: ["SON", "RUN", "FUN", "SUN"] },
                { word: "PIG", correct: "PIG", options: ["PEG", "BIG", "PIG", "BAG"] },
                { word: "FOX", correct: "FOX", options: ["BOX", "FIX", "FAX", "FOX"] },
                { word: "MOP", correct: "MOP", options: ["MAP", "TOP", "MOP", "MAD"] },
                { word: "TEN", correct: "TEN", options: ["TIN", "PIN", "MEN", "TEN"] },
                { word: "JUG", correct: "JUG", options: ["JOG", "BUG", "JUG", "BOG"] },
                { word: "LIP", correct: "LIP", options: ["LAP", "LIP", "LEP", "SIP"] },
                { word: "VAN", correct: "VAN", options: ["VET", "VIM", "FAN", "VAN"] },
            ]},
            // LEVEL 2: Simple Vowels/Consonants (‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ‡∏°‡∏µ Distractor ‡∏ó‡∏µ‡πà‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡πÄ‡∏™‡∏µ‡∏¢‡∏á)
            { level: 2, title: "‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏û‡∏¢‡∏±‡∏ç‡∏ä‡∏ô‡∏∞‡∏ï‡πâ‡∏ô", questions: [
                { word: "DOG", correct: "DOG", options: ["DOG", "FOG", "LOG", "JOG"] },
                { word: "CAT", correct: "CAT", options: ["SAT", "MAT", "CAT", "CUT"] },
                { word: "FISH", correct: "FISH", options: ["DISH", "FISH", "WISH", "FUSS"] },
                { word: "BIRD", correct: "BIRD", options: ["BEARD", "GIRL", "BIRD", "BORED"] },
                { word: "COW", correct: "COW", options: ["NOW", "WOW", "COW", "CAN"] },
                { word: "PIG", correct: "PIG", options: ["BIG", "PEG", "PIG", "BAG"] },
                { word: "FROG", correct: "FROG", options: ["LOG", "FROG", "RAG", "FRAG"] },
                { word: "BOAT", correct: "BOAT", options: ["BOOT", "GOAT", "BOAT", "BITE"] },
                { word: "CAR", correct: "CAR", options: ["CAT", "FAR", "BAR", "CAR"] },
                { word: "APPLE", correct: "APPLE", options: ["ORANGE", "APRIL", "APPLE", "EAGLE"] },
            ]},
            // LEVEL 3: Fruits (‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ü‡∏±‡∏á)
            { level: 3, title: "‡∏ú‡∏•‡πÑ‡∏°‡πâ", questions: [
                { word: "APPLE", correct: "APPLE", options: ["APRIL", "EAGLE", "APPLE", "ACID"] },
                { word: "BANANA", correct: "BANANA", options: ["MANNA", "BANANA", "BANDANA", "BONANZA"] },
                { word: "GRAPE", correct: "GRAPE", options: ["GRATE", "GREAT", "GRAPE", "GRIP"] },
                { word: "ORANGE", correct: "ORANGE", options: ["ARRANGE", "ORANGE", "BORING", "ORION"] },
                { word: "STRAWBERRY", correct: "STRAWBERRY", options: ["STROLL", "STRAWBERRY", "STARRY", "STRIP"] },
                { word: "WATERMELON", correct: "WATERMELON", options: ["WATER", "WAITER", "WATERMELON", "WELON"] },
                { word: "KIWI", correct: "KIWI", options: ["KEVIN", "KID", "KIWI", "WIKI"] },
                { word: "CHERRY", correct: "CHERRY", options: ["CHAIR", "CHERRY", "CHEERY", "JERRY"] },
                { word: "PEACH", correct: "PEACH", options: ["PITCH", "PEEK", "PEACH", "PENCIL"] },
                { word: "PEAR", correct: "PEAR", options: ["PAIR", "PRAY", "PIER", "PEAR"] },
            ]},
             // LEVEL 4-10 ‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ö‡∏ö Rhyming 
            { level: 4, title: "‡∏≠‡∏ß‡∏±‡∏¢‡∏ß‡∏∞", questions: [
                { word: "HEAD", correct: "HEAD", options: ["HAT", "HEART", "HEAD", "HAND"] }, 
                { word: "EYE", correct: "EYE", options: ["I", "HIGH", "EYE", "EAT"] },
                { word: "NOSE", correct: "NOSE", options: ["KNOWS", "NOSE", "NICE", "NOWS"] },
                { word: "MOUTH", correct: "MOUTH", options: ["MOUSE", "SOUTH", "MOUTH", "MUST"] },
                { word: "EAR", correct: "EAR", options: ["HERE", "EAR", "YEAR", "ARE"] },
                { word: "HAND", correct: "HAND", options: ["HAVE", "HAD", "HAND", "HEAR"] },
                { word: "FOOT", correct: "FOOT", options: ["FEET", "FOOD", "FOOT", "FUT"] },
                { word: "ARM", correct: "ARM", options: ["HARM", "FARM", "ARM", "ALM"] },
                { word: "LEG", correct: "LEG", options: ["LICK", "LAG", "LEG", "LUG"] },
                { word: "FINGER", correct: "FINGER", options: ["FINGERS", "SINGER", "FINGER", "FEN"] },
            ]},
            { level: 5, title: "‡∏¢‡∏≤‡∏ô‡∏û‡∏≤‡∏´‡∏ô‡∏∞", questions: [
                { word: "CAR", correct: "CAR", options: ["FAR", "CORE", "CAR", "CROW"] },
                { word: "BUS", correct: "BUS", options: ["BOSS", "BASE", "BUS", "BUZZ"] },
                { word: "TRAIN", correct: "TRAIN", options: ["RAIN", "TRIM", "TRAIN", "TRY"] },
                { word: "BIKE", correct: "BIKE", options: ["BOOK", "BIKE", "BACK", "HIKE"] },
                { word: "BOAT", correct: "BOAT", options: ["BOUGHT", "BITE", "BOAT", "BEND"] },
                { word: "PLANE", correct: "PLANE", options: ["PLANT", "PLAY", "PLAN", "PLANE"] },
                { word: "TRUCK", correct: "TRUCK", options: ["TRICK", "TRACK", "TUCK", "TRUCK"] },
                { word: "SCOOTER", correct: "SCOOTER", options: ["SHOOTER", "SCHOOL", "SCOOTER", "SKATER"] },
                { word: "TAXI", correct: "TAXI", options: ["TAX", "TACKY", "TAXI", "TESS"] },
                { word: "SHIP", correct: "SHIP", options: ["SHEEP", "CHIP", "SKIP", "SHIP"] },
            ]},
            { level: 6, title: "‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤", questions: [
                { word: "SHIRT", correct: "SHIRT", options: ["SHORT", "SHOT", "SHIRT", "SIT"] },
                { word: "DRESS", correct: "DRESS", options: ["DRAW", "DRINK", "DRESS", "DREAMS"] },
                { word: "SHOES", correct: "SHOES", options: ["SHOWS", "CHOOSE", "SHOES", "SHOT"] },
                { word: "HAT", correct: "HAT", options: ["HUT", "HATE", "HAT", "HART"] },
                { word: "SOCKS", correct: "SOCKS", options: ["SIX", "SOX", "SOCKS", "SAX"] },
                { word: "PANTS", correct: "PANTS", options: ["PATIENTS", "PAINTS", "PANTS", "PUNT"] },
                { word: "SKIRT", correct: "SKIRT", options: ["SKIP", "SKATE", "SKIRT", "SQUARE"] },
                { word: "COAT", correct: "COAT", options: ["CUT", "COTE", "COAT", "COT"] },
                { word: "SCARF", correct: "SCARF", options: ["SCOOP", "SCAR", "SCARF", "SKIRT"] },
                { word: "GLOVES", correct: "GLOVES", options: ["GLOVE", "LOVES", "GLOVES", "GLUM"] },
            ]},
            { level: 7, title: "‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß", questions: [
                { word: "MOTHER", correct: "MOTHER", options: ["BROTHER", "MUD", "MOTHER", "MASTER"] },
                { word: "FATHER", correct: "FATHER", options: ["FARTHER", "FASTER", "FATHER", "FIGHTER"] },
                { word: "SISTER", correct: "SISTER", options: ["SIR", "SITTER", "SISTER", "SESTER"] },
                { word: "BROTHER", correct: "BROTHER", options: ["BREATH", "BROTHER", "BRUSH", "BUTTER"] },
                { word: "BABY", correct: "BABY", options: ["BOBBY", "BYE", "BABY", "BUSY"] },
                { word: "GRANDMA", correct: "GRANDMA", options: ["GRANDPA", "GRAMMAR", "GRANDMA", "GRADE"] },
                { word: "GRANDPA", correct: "GRANDPA", options: ["GRANDMA", "GRANTER", "GRANDPA", "GRIN"] },
                { word: "AUNT", correct: "AUNT", options: ["ANT", "AREN'T", "AUNT", "ONCE"] },
                { word: "UNCLE", correct: "UNCLE", options: ["ANKLE", "UNCLE", "UNKLE", "INK"] },
                { word: "FRIEND", correct: "FRIEND", options: ["FINED", "FRY", "FRIEND", "FRONT"] },
            ]},
            { level: 8, title: "‡∏≠‡∏≤‡∏´‡∏≤‡∏£", questions: [
                { word: "PIZZA", correct: "PIZZA", options: ["PEACE", "PIXEL", "PIZZA", "PETS"] },
                { word: "BREAD", correct: "BREAD", options: ["BLED", "BROAD", "BREAD", "BIRD"] },
                { word: "MILK", correct: "MILK", options: ["MILL", "MELK", "MILK", "MAIL"] },
                { word: "EGG", correct: "EGG", options: ["AGE", "LEG", "EGG", "AIL"] },
                { word: "CHEESE", correct: "CHEESE", options: ["CHAIR", "CHIN", "CHEESE", "CHEST"] },
                { word: "CARROT", correct: "CARROT", options: ["CARRY", "CAR", "CARROT", "CURRY"] },
                { word: "SOUP", correct: "SOUP", options: ["SOP", "SOAP", "SOUP", "SUP"] },
                { word: "CAKE", correct: "CAKE", options: ["CATCH", "COOK", "CAKE", "KICK"] },
                { word: "WATER", correct: "WATER", options: ["WAITER", "WETTER", "WATER", "WHITER"] },
                { word: "COOKIE", correct: "COOKIE", options: ["CUCKOO", "COOKY", "COOKIE", "KICK"] },
            ]},
            { level: 9, title: "‡∏Å‡∏£‡∏¥‡∏¢‡∏≤", questions: [
                { word: "RUN", correct: "RUN", options: ["WREN", "RAN", "RUN", "RAW"] },
                { word: "JUMP", correct: "JUMP", options: ["DUMP", "GUM", "JUMP", "GEM"] },
                { word: "SLEEP", correct: "SLEEP", options: ["SLIP", "SLAP", "SLEEP", "SLIT"] },
                { word: "EAT", correct: "EAT", options: ["IT", "EIGHT", "EAT", "HIT"] },
                { word: "DRINK", correct: "DRINK", options: ["DRANK", "DREAM", "DRINK", "DRIVE"] },
                { word: "READ", correct: "READ", options: ["RED", "REED", "READ", "RID"] },
                { word: "SING", correct: "SING", options: ["SANG", "SIN", "SING", "SONG"] },
                { word: "WALK", correct: "WALK", options: ["WOKE", "WORK", "WALK", "WACK"] },
                { word: "PLAY", correct: "PLAY", options: ["PULL", "PLACE", "PLAY", "PLOW"] },
                { word: "TALK", correct: "TALK", options: ["WALK", "TOLL", "TALK", "TUCK"] },
            ]},
            { level: 10, title: "‡∏Ñ‡∏≥‡∏Ñ‡∏∏‡∏ì‡∏®‡∏±‡∏û‡∏ó‡πå", questions: [
                { word: "HAPPY", correct: "HAPPY", options: ["HOPPY", "HEP", "HAPPY", "HI-P"] },
                { word: "SAD", correct: "SAD", options: ["SAID", "SAT", "SAD", "SEND"] },
                { word: "BIG", correct: "BIG", options: ["BAG", "BEG", "BIG", "BOG"] },
                { word: "SMALL", correct: "SMALL", options: ["SMELL", "SMASH", "SMALL", "MALL"] },
                { word: "HOT", correct: "HOT", options: ["HUT", "HATE", "HOT", "HEART"] },
                { word: "COLD", correct: "COLD", options: ["CALL", "CODE", "COLD", "COULD"] },
                { word: "FAST", correct: "FAST", options: ["FEST", "FIST", "FAST", "FACE"] },
                { word: "SLOW", correct: "SLOW", options: ["SLAUGHTER", "FLOW", "SLOW", "SLIM"] },
                { word: "CLEAN", correct: "CLEAN", options: ["CLIN", "CLONE", "CLEAN", "CLEAR"] },
                { word: "DIRTY", correct: "DIRTY", options: ["DUSTY", "DARE", "DIRTY", "DEER"] },
            ]},
        ];

        const OPTIONS_COUNT = 4;
        const MAX_REPLAY_COUNT = 3; 

        // --- ELEMENTS & TTS SETUP ---
        const levelSelectScreen = document.getElementById('level-select-screen');
        const gameScreen = document.getElementById('game-screen');
        const levelGridEl = document.getElementById('level-grid');
        const levelTitleEl = document.getElementById('level-title');
        const qCountEl = document.getElementById('q-count');
        const scoreEl = document.getElementById('score');
        // const wordPromptTextEl = document.getElementById('word-prompt-text'); // **‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡πÉ‡∏ô HTML ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏á‡πÑ‡∏ß‡πâ‡πÉ‡∏ô JS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô error**
        const audioButton = document.getElementById('audio-button');
        const feedbackMessageEl = document.getElementById('feedback-message');
        const optionsArea = document.getElementById('options-area');
        const nextBtn = document.getElementById('next-btn');

        // TTS Variables
        const synth = window.speechSynthesis;
        let voice = null; 
        let isSpeaking = false;


        // --- GAME STATE ---
        let currentLevelData = null;
        let currentQuizIndex = 0; 
        let score = 0;
        let isAnswered = false;
        let currentWord = {}; // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
        let audioPlayCount = 0; 

        // --- TTS FUNCTIONS ---

        function initTTS() {
            if (voice) return;

            const voices = synth.getVoices();
            // ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏´‡∏≤‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡πÅ‡∏ö‡∏ö US
            voice = voices.find(v => v.lang === 'en-US' || v.lang.startsWith('en-')); 
            
            if (!voice && voices.length > 0) {
                 voice = voices[0];
            }
            if (!voice) {
                 console.error("No compatible voice found for TTS.");
            }
        }
        
        function speakWord(word) {
            if (!synth || !word || isSpeaking) return;
            
            synth.cancel(); 
            
            const utterance = new SpeechSynthesisUtterance(word);
            utterance.lang = 'en-US'; 
            utterance.rate = 0.9; 
            utterance.voice = voice;
            
            utterance.onstart = () => { isSpeaking = true; audioButton.disabled = true; };
            utterance.onend = () => { 
                isSpeaking = false; 
                if (!isAnswered && audioPlayCount < MAX_REPLAY_COUNT) {
                    audioButton.disabled = false;
                }
            };
            
            synth.speak(utterance);
        }

        function speakFeedback(message) {
            if (!synth || !message) return;
            
            synth.cancel();
            const utterance = new SpeechSynthesisUtterance(message);
            utterance.lang = 'en-US'; 
            utterance.rate = 1.0; 
            utterance.voice = voice;
            synth.speak(utterance);
        }
        
        // --- AUDIO CONTROL LOGIC (TTS) ---

        function tryAutoPlayTTS() {
            if (isAnswered) return;
            
            // ‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå (currentWord.word)
            speakWord(currentWord.word);
            audioPlayCount = 1; 
            updateAudioButtonState();
        }
        
        function playWordAudioByUserClickTTS() {
            if (isAnswered || isSpeaking) return;
            
            if (audioPlayCount < MAX_REPLAY_COUNT) {
                speakWord(currentWord.word);
                audioPlayCount++;
                updateAudioButtonState();
            }
        }
        
        function updateAudioButtonState() {
            if (isAnswered || isSpeaking) {
                 audioButton.disabled = true;
                 return;
            }
            
            if (audioPlayCount >= MAX_REPLAY_COUNT) {
                audioButton.disabled = true;
                feedbackMessageEl.textContent = '‡∏´‡∏°‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ü‡∏±‡∏á‡∏ã‡πâ‡∏≥‡πÅ‡∏•‡πâ‡∏ß';
                feedbackMessageEl.style.color = 'var(--color-wrong)';
            } else {
                audioButton.disabled = false;
                const remaining = MAX_REPLAY_COUNT - audioPlayCount;

                if (audioPlayCount === 0) {
                    feedbackMessageEl.textContent = `üîä ‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡∏•‡∏≥‡πÇ‡∏û‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ü‡∏±‡∏á‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå (‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏µ‡∏Å ${MAX_REPLAY_COUNT} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á)`;
                } else if (remaining > 0) {
                    feedbackMessageEl.textContent = `üîä ‡∏ü‡∏±‡∏á‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å ${remaining} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á`;
                } else {
                    feedbackMessageEl.textContent = `üîä ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ü‡∏±‡∏á‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ!`;
                }
            }
        }


        // --- GAME LOGIC ---

        function createLevelButtons() {
            levelGridEl.innerHTML = '';
            
            ALL_LEVEL_WORDS.forEach(data => {
                const btn = document.createElement('button');
                btn.className = 'level-btn';
                btn.textContent = `Level ${data.level}`;
                
                const titleSpan = document.createElement('span');
                titleSpan.className = 'level-btn-title';
                titleSpan.textContent = data.title;
                
                btn.appendChild(titleSpan);
                btn.setAttribute('data-level', data.level);
                
                btn.addEventListener('click', () => {
                    startLevel(data.level);
                });
                levelGridEl.appendChild(btn);
            });
        }

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(id).classList.add('active');
        }


        function updateStatusBar() {
            if (currentLevelData) {
                levelTitleEl.textContent = `${currentLevelData.title} (Level ${currentLevelData.level})`;
                qCountEl.textContent = `‡∏Ç‡πâ‡∏≠: ${currentQuizIndex + 1}/${currentLevelData.questions.length}`;
            }
            scoreEl.textContent = `‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: ${score}`;
        }


        function startLevel(levelId) {
            currentLevelData = ALL_LEVEL_WORDS.find(data => data.level === levelId);
            currentQuizIndex = 0;
            score = 0; 
            showScreen('game-screen'); 
            nextQuestion();
        }

        function nextQuestion() {
            if (currentQuizIndex >= currentLevelData.questions.length) {
                endGame();
                return;
            }
            
            isAnswered = false;
            audioPlayCount = 0; 
            
            nextBtn.textContent = '‡∏Ç‡πâ‡∏≠‡∏ñ‡∏±‡∏î‡πÑ‡∏õ';
            nextBtn.disabled = true;
            feedbackMessageEl.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå...';
            feedbackMessageEl.style.color = 'var(--color-text-dark)';

            optionsArea.innerHTML = ''; 
            
            // ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏£‡∏≤‡∏•‡∏ö‡∏Ñ‡∏≥‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô Text ‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∂‡∏á‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
            // document.getElementById('word-prompt-text').textContent = ''; 
            
            updateStatusBar();
            setupQuestion();
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ñ‡∏π‡∏Å‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ‡πÉ‡∏ô Data ‡πÅ‡∏•‡πâ‡∏ß
        function getGameOptions() {
            const currentQuestion = currentLevelData.questions[currentQuizIndex]; 
            currentWord = currentQuestion;
            
            // ‡∏™‡∏∏‡πà‡∏° shuffle ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏°‡∏≤
            const options = currentQuestion.options.map(word => ({ word: word, isCorrect: word === currentQuestion.correct }));
            
            return options.sort(() => Math.random() - 0.5); 
        }


        function setupQuestion() {
            const options = getGameOptions();
            
            // 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            options.forEach(item => {
                const button = document.createElement('button');
                button.className = 'option-btn';
                button.dataset.word = item.word;
                button.dataset.isCorrect = item.isCorrect;
                
                // 5. ‡∏•‡∏ö‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô (item-icon) ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏õ‡∏∏‡πà‡∏°
                button.innerHTML = `
                    <span class="item-word">${item.word.toUpperCase()}</span>
                `;
                button.addEventListener('click', handleAnswer);
                optionsArea.appendChild(button);
            });
            
            // 2. ‡∏•‡∏≠‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (TTS ‡∏à‡∏∞‡∏≠‡πà‡∏≤‡∏ô currentWord.word)
            tryAutoPlayTTS();
            
            // 3. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô 
            updateAudioButtonState(); 
        }

        function handleAnswer(event) {
            if (isAnswered) return;
            isAnswered = true;
            
            const selectedButton = event.currentTarget;
            const isCorrect = selectedButton.dataset.isCorrect === 'true';

            synth.cancel(); 
            audioButton.disabled = true;

            // 1. Disable all choices
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.removeEventListener('click', handleAnswer);
                btn.disabled = true;
            });

            // 2. Feedback
            if (isCorrect) {
                score++;
                selectedButton.classList.add('correct');
                feedbackMessageEl.textContent = `‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!`;
                feedbackMessageEl.style.color = 'var(--color-correct)';
                speakFeedback("Correct!");
            } else {
                selectedButton.classList.add('incorrect');
                feedbackMessageEl.textContent = `‚ùå ‡∏ú‡∏¥‡∏î! ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏∑‡∏≠ ${currentWord.correct.toUpperCase()}`;
                feedbackMessageEl.style.color = 'var(--color-wrong)';
                speakFeedback("Incorrect!");
                
                // Highlight the correct answer
                const correctAnswerButton = document.querySelector(`.option-btn[data-is-correct="true"]`);
                if (correctAnswerButton) {
                    correctAnswerButton.classList.add('correct');
                }
            }
            
            // 3. Update status and enable next button
            updateStatusBar();
            nextBtn.disabled = false;
        }


        function endGame() {
            levelTitleEl.textContent = `‡∏à‡∏ö Level ${currentLevelData.level}!`;
            qCountEl.textContent = '';
            
            const totalQuestions = currentLevelData.questions.length;
            feedbackMessageEl.innerHTML = `
                <span style="font-size:2rem; font-weight:900; color:var(--color-primary);">
                    ‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏≥‡πÑ‡∏î‡πâ ${score}/${totalQuestions} ‡∏Ç‡πâ‡∏≠
                </span>
            `;
            feedbackMessageEl.style.color = 'var(--color-primary)';
            
            optionsArea.innerHTML = ''; 
            
            nextBtn.textContent = '‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å';
            nextBtn.disabled = false;
        }

        // --- EVENT LISTENERS ---
        
        audioButton.addEventListener('click', () => {
             playWordAudioByUserClickTTS();
        });

        nextBtn.addEventListener('click', () => {
            synth.cancel(); 
            if (currentQuizIndex >= currentLevelData.questions.length - 1 && nextBtn.textContent === '‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å') { 
                showScreen('level-select-screen');
                currentQuizIndex = 0; 
                return;
            }
            
            currentQuizIndex++;
            nextQuestion();
            
        });


        // --- INITIAL SETUP ---
        document.addEventListener('DOMContentLoaded', () => {
            createLevelButtons();
            showScreen('level-select-screen');
            
            // ‡πÇ‡∏´‡∏•‡∏î TTS Voice ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏û‡∏£‡πâ‡∏≠‡∏° (‡∏ß‡∏¥‡∏ò‡∏µ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô)
            if (synth && synth.onvoiceschanged !== undefined) {
                synth.onvoiceschanged = initTTS;
            } else if (synth) {
                // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ onvoiceschanged
                initTTS();
            }
        });
    </script>
</body>
</html>
